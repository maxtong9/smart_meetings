<p id="notice"><%= notice %></p>

<p>
  <strong>Name:</strong>
  <%= @meeting.name %>
</p>
<p>
  <strong>Number of Participants:</strong>
  <%= @meeting.participants %>
</p>
<% if @meeting.file.attachments.first != nil %>
  <p>
    <b>Attached Files: </b>
    <br />
    <% for i in 0..@meeting.participants-1 do %>
      <p>
        <%=  @meeting.file.attachments[i].filename %>
        <br />
      </p>
    <% end %>
  </p>
  <p>
    <% json_from_file = File.read("tmp/" + @meeting.file.attachments.last.filename.to_s()) %>
    <% hash = JSON.parse(json_from_file, object_class: OpenStruct) %>
    <p> <b> Summary </b> </p>
    <% temp = 0 %>
    <% p = 0 %>
    <% string_s = '' %>
    <% for i in hash.summary %>
        <% if temp == 0 %>
          <% string_s = i[1][0...-1] %>
          <% p = i[0] %>
          <% temp = temp+1 %>
        <% else %>
          <% if p == i[0] %>
            <% string_s = string_s+ ' ' + i[1][0...-1] %>
            <% if temp == hash.summary.length-1 %>
              <p> <%= p[0...-1] %>: <%=string_s%></p>
            <% end %>
          <% else %>
            <p> <%= p[0...-1] %>: <%=string_s%></p>
            <% string_s = i[1][0...-1] %>
            <% p = i[0] %>
          <% end %>
          <% temp = temp+1 %>
        <% end %>

    <% end %>

    <p> <b> Questions </b> </p>
    <% if hash.questions.length != 0 %>
      <% for i in hash.questions %>
         <p> <%= i[0] %>: <%= i[1]%> </p>
      <% end %>
    <% else %>
      <p> None </p>
    <% end %>

    <p> <b> Action Items </b> </p>
    <% if hash.action_items.length != 0 %>
      <% for i in hash.action_items %>
        <p> <%= i[0] %>: <%= i[1]%> </p>
      <% end %>
    <% else %>
      <p> None </p>
    <% end %>


    <p> <b> Hesitations </b> </p>
    <% if hash.hesitation_analytics.length != 0 %>
      <% for i in hash.hesitation_analytics %>
        <p> <%= i[0] %>: <%= i[1]%> </p>
      <% end %>
    <% else %>
      <p> None </p>
    <% end %>

    <p> <b> Transcription </b> </p>
    <% temp1 = 0 %>
    <% p1 = '' %>
    <% string1 = '' %>
    <% for i in hash.raw %>
        <% if temp1 == 0 %>
          <% string1 = i[1] %>
          <% p1 = i[0] %>
          <% temp1 = temp1+1 %>
        <% else %>
          <% if p1 == i[0] %>
            <% string1 = string1+i[1] %>
            <% if temp1 == hash.raw.length-1 %>
              <p><%= p1[0...-1] %>: <%=string1%></p>
              <% string1 = '' %>
            <% end %>
          <% else %>
            <p><%= p1[0...-1]%>: <%=string1%></p>
            <% string1 = '' %>
            <% string1 = i[1] %>
            <% p1 = i[0] %>
          <% end %>
          <% temp1 = temp1+1 %>
        <% end %>

    <% end %>
  </p>
<% else %>
  <p>
    No Attached File
    <%= render 'upload_form', meeting: @meeting %>
  </p>
<% end %>
<a class="a-style"><%= link_to 'Edit', edit_meeting_path(@meeting) %> |
<%= link_to 'Back', meetings_path %></a>
